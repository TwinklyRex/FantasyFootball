"0","```r
# H0: p = 0.7
# HA: p != 0.7

p <- 0.7

# sample size
n <- 120

# sample proportion
p_hat <- 78/120

# Test statistic
z <- (p_hat - p) / sqrt(p * (1 - p) / n)
paste0(\"z = \", round(z, 1))
```"
"1","[1] \"z = -1.2\"
"
"0","```r
# because we have two sided test p_value is calculated as follows
p_value <- 2 * pnorm(z)
p_value <- round(p_value, 3)
paste0(\"p_value = \", p_value)
```"
"1","[1] \"p_value = 0.232\"
"
"0","```r
paste0(\"The test is not significant at 5% level and H0 is not rejected in favour of HA because p_value = \", 
       p_value * 100,
       \"% > 5%.\"
)
```"
"1","[1] \"The test is not significant at 5% level and H0 is not rejected in favour of HA because p_value = 23.2% > 5%.\"
"
"0","```r
# 95% C.I.
z_critical <- qnorm(0.975)

ci <- c(p_hat - z_critical * sqrt(p * (1-p) / n), p_hat + z_critical * sqrt(p * (1-p) / n))
ci <- round(ci, 3)

paste0(\"95% C.I. is [\", ci[1], \", \", ci[2], \"]\")
```"
"1","[1] \"95% C.I. is [0.568, 0.732]\"
"
"0","```r
# or alternatively 
test_results <- prop.test(x = c(78), n = c(120), p = c(0.7), correct = F, alternative = \"two.sided\")
test_results
```"
"1","
	1-sample proportions test without
	continuity correction

data:  c(78) out of c(120), null probability c(0.7)
X-squared = 1.4286, df = 1, p-value =
0.232
alternative hypothesis: true p is not equal to 0.7
95 percent confidence interval:
 0.5612132 0.7294810
sample estimates:
   p 
0.65 
"
"0","```r
p_value_alt <- round(test_results$p.value, 3)
paste0(\"p_value_alt = \", p_value_alt)
```"
"1","[1] \"p_value_alt = 0.232\"
"
"0","```r
p_value_alt == p_value
```"
"1","[1] TRUE
"
"0","```r
paste0(\"The test is not significant at 5% level and H0 is not rejected in favour of HA because p_value_alt = \", 
       p_value_alt * 100,
       \"% > 5%.\"
)
```"
"1","[1] \"The test is not significant at 5% level and H0 is not rejected in favour of HA because p_value_alt = 23.2% > 5%.\"
"
"0","```r
# Slightly different values of the 95% CI are obtained because
# R's CI formula is based on the Yates continuity correction formula which is used in Chi-square tests
ci_alt <- test_results$conf.int
ci_alt <- round(ci_alt, 3)

paste0(\"95% C.I. is [\", ci_alt[1], \", \", ci_alt[2], \"]\")
```"
"1","[1] \"95% C.I. is [0.561, 0.729]\"
"
